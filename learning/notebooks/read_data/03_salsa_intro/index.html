
<!DOCTYPE html>


<html lang="en" data-content_root="../../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>ECHAM-SALSA Aerosol Data Introduction &#8212; eScience-2025  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/graphviz.css?v=fd3f3429" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/css/sphinx-toolbox.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/tabs.css?v=a5c4661c" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/sphinx_toolbox_installation.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../../../_static/documentation_options.js?v=55b5f74b"></script>
    <script src="../../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script src="../../../../_static/sphinx_toolbox_installation.js"></script>
    <script src="../../../../_static/design-tabs.js?v=f930bc37"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'learning/notebooks/read_data/03_salsa_intro';</script>
    <link rel="icon" href="../../../../_static/es-logo.ico"/>
    <link rel="index" title="Index" href="../../../../genindex/" />
    <link rel="search" title="Search" href="../../../../search/" />
    <link rel="next" title="Exporting notebooks" href="../../../../nbcon-pdf/" />
    <link rel="prev" title="Read CMIP-PPE data and emulate with Gaussian Processor" href="../02_read_PPE/" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../../search/"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../../../">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../../_static/es-logo.png" class="logo__image only-light" alt="eScience-2025  documentation - Home"/>
    <script>document.write(`<img src="../../../../_static/es-logo.png" class="logo__image only-dark" alt="eScience-2025  documentation - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../../">
                    eScience 2025 course
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../../feide/">Jupyterhub access</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../course_workflow/">Workflow for eScience2025 course</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../course_workflow/workflow/">Basic setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../course_workflow/rules/">Basic Rules for the course</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../course_workflow/data/">Sharing data</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../basics/">Jupyterhub basic usage</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../basics/start_stop/">Starting and stopping your server</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../basics/lab/">The JupyterLab Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../basics/kernels/">Using different kernels in notebooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../basics/settings/">JupyterLab settings</a></li>

</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../data/">Data</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../data/Intake-data-acess/">Acessing model data using intake-esm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../data/local-data/">Local shared data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../data/ACTRIS-data/">ACTRIS data</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../git_integration/">Using version control on Jupyterhub:</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../git_integration/git_jlab/">Starting with git on the jupyterhub</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../git_integration/remotes/">Setting up remotes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../git_integration/github-work/">Pull requests and Issues</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../git_integration/conflicts/">Resolving merge/rebase conflicts</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../common/">General tips</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../common/terminal/">Using command terminal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../common/resources/">Monitoring resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../common/debug/">Using debugger</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../../../">Learning Corner</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../../us-links/">Useful links</a></li>

<li class="toctree-l2 current active has-children"><a class="reference internal" href="../../">Example Notebooks</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l3 has-children"><a class="reference internal" href="../../basic_python/">Python tips &amp; tricks</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../basic_python/01_some-xarray-pandas-presentation_Sara/">Some tips with xarray and pandas</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../basic_python/02_making_a_nice_table_for_michael/">Making a nice table</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../basic_python/03_dask_intro/">Brief introduction to Dask</a></li>


<li class="toctree-l4"><a class="reference internal" href="../../basic_python/04_own-modules/">Making your own modules and some numba tips</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../basic_python/05_markdown_example/">How to use Markdown in Jupyter notebook</a></li>

</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../netcdf/">Reading files and regridding</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../netcdf/01_interpolate_hybridsigma2pressure_coords/">Interpolate hybrid sigma pressure coordinates to pressure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../netcdf/02_xesmf_regridding/">Regridding model data with xESMF</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../netcdf/03_masked_and_weighted_average/">Using masks and computing weighted average</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../netcdf/04_mask_land/">Mask land</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../netcdf/05_projections/">Using cartopy and projections for plotting</a></li>
</ul>
</details></li>
<li class="toctree-l3 current active has-children"><a class="reference internal" href="../">Specific examples</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../01_from_ebas_using_xarray/">Using xarray to read EBAS data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../02_read_PPE/">Read CMIP-PPE data and emulate with Gaussian Processor</a></li>
<li class="toctree-l4 current active"><a class="current reference internal" href="#">ECHAM-SALSA Aerosol Data Introduction</a></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../nbcon-pdf/">Exporting notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../contrib/">Contribute to this page</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../license/">Credit</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/MetOs-UiO/eScience2025" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/MetOs-UiO/eScience2025/edit/master/docs/learning/notebooks/read_data/03_salsa_intro.ipynb" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/MetOs-UiO/eScience2025/issues/new?title=Issue%20on%20page%20%2Flearning/notebooks/read_data/03_salsa_intro.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../../_sources/learning/notebooks/read_data/03_salsa_intro.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>ECHAM-SALSA Aerosol Data Introduction</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#salsa-aerosol-bin-structure">SALSA aerosol bin structure</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-subsets">Data subsets</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-dictionary">Create a dictionary</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#station-names">Station names</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example">Example</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualization">Visualization</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="echam-salsa-aerosol-data-introduction">
<h1>ECHAM-SALSA Aerosol Data Introduction<a class="headerlink" href="#echam-salsa-aerosol-data-introduction" title="Link to this heading">#</a></h1>
<p>General introduction how the station co-located ECHAM-SALSA data can be read using the online catalog and used for a small cluster analysis.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># general</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">intake</span>
<span class="c1"># dask</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">dask</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">dask.array</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">da</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">dask.distributed</span><span class="w"> </span><span class="kn">import</span> <span class="n">Client</span>
<span class="c1"># statistics</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">scipy.cluster.hierarchy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sch</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.spatial.distance</span><span class="w"> </span><span class="kn">import</span> <span class="n">pdist</span><span class="p">,</span> <span class="n">squareform</span>
</pre></div>
</div>
</div>
</div>
<p>Since we are working with large datasets, we use <a class="reference external" href="https://metos-uio.github.io/eScience2025/learning/notebooks/dask_intro/">Dask</a> to avoid overloading the memory.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">()</span>
<span class="n">client</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/envs/pangeo-notebook/lib/python3.11/site-packages/distributed/node.py:182: UserWarning: Port 8787 is already in use.
Perhaps you already have a cluster running?
Hosting the HTTP server on port 41461 instead
  warnings.warn(
</pre></div>
</div>
<div class="output text_html"><div>
    <div style="width: 24px; height: 24px; background-color: #e1e1e1; border: 3px solid #9D9D9D; border-radius: 5px; position: absolute;"> </div>
    <div style="margin-left: 48px;">
        <h3 style="margin-bottom: 0px;">Client</h3>
        <p style="color: #9D9D9D; margin-bottom: 0px;">Client-034fe6af-2795-11f0-ae8f-5a3dbe771ea2</p>
        <table style="width: 100%; text-align: left;">

        <tr>
        
            <td style="text-align: left;"><strong>Connection method:</strong> Cluster object</td>
            <td style="text-align: left;"><strong>Cluster type:</strong> distributed.LocalCluster</td>
        
        </tr>

        
            <tr>
                <td style="text-align: left;">
                    <strong>Dashboard: </strong> <a href="/user/fc%3Auid%3Ac001c18e-88e2-449d-be62-663893db7f63/proxy/41461/status" target="_blank">/user/fc%3Auid%3Ac001c18e-88e2-449d-be62-663893db7f63/proxy/41461/status</a>
                </td>
                <td style="text-align: left;"></td>
            </tr>
        

        </table>

        
            <button style="margin-bottom: 12px;" data-commandlinker-command="dask:populate-and-launch-layout" data-commandlinker-args='{"url": "/user/fc%3Auid%3Ac001c18e-88e2-449d-be62-663893db7f63/proxy/41461/status" }'>
                Launch dashboard in JupyterLab
            </button>
        

        
            <details>
            <summary style="margin-bottom: 20px;"><h3 style="display: inline;">Cluster Info</h3></summary>
            <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-mod-trusted jp-OutputArea-output">
    <div style="width: 24px; height: 24px; background-color: #e1e1e1; border: 3px solid #9D9D9D; border-radius: 5px; position: absolute;">
    </div>
    <div style="margin-left: 48px;">
        <h3 style="margin-bottom: 0px; margin-top: 0px;">LocalCluster</h3>
        <p style="color: #9D9D9D; margin-bottom: 0px;">91fec4af</p>
        <table style="width: 100%; text-align: left;">
            <tr>
                <td style="text-align: left;">
                    <strong>Dashboard:</strong> <a href="/user/fc%3Auid%3Ac001c18e-88e2-449d-be62-663893db7f63/proxy/41461/status" target="_blank">/user/fc%3Auid%3Ac001c18e-88e2-449d-be62-663893db7f63/proxy/41461/status</a>
                </td>
                <td style="text-align: left;">
                    <strong>Workers:</strong> 4
                </td>
            </tr>
            <tr>
                <td style="text-align: left;">
                    <strong>Total threads:</strong> 16
                </td>
                <td style="text-align: left;">
                    <strong>Total memory:</strong> 16.00 GiB
                </td>
            </tr>
            
            <tr>
    <td style="text-align: left;"><strong>Status:</strong> running</td>
    <td style="text-align: left;"><strong>Using processes:</strong> True</td>
</tr>

            
        </table>

        <details>
            <summary style="margin-bottom: 20px;">
                <h3 style="display: inline;">Scheduler Info</h3>
            </summary>

            <div style="">
    <div>
        <div style="width: 24px; height: 24px; background-color: #FFF7E5; border: 3px solid #FF6132; border-radius: 5px; position: absolute;"> </div>
        <div style="margin-left: 48px;">
            <h3 style="margin-bottom: 0px;">Scheduler</h3>
            <p style="color: #9D9D9D; margin-bottom: 0px;">Scheduler-82b6ad00-cd7b-457d-aff2-6fef7a0878a0</p>
            <table style="width: 100%; text-align: left;">
                <tr>
                    <td style="text-align: left;">
                        <strong>Comm:</strong> tcp://127.0.0.1:40099
                    </td>
                    <td style="text-align: left;">
                        <strong>Workers:</strong> 4
                    </td>
                </tr>
                <tr>
                    <td style="text-align: left;">
                        <strong>Dashboard:</strong> <a href="/user/fc%3Auid%3Ac001c18e-88e2-449d-be62-663893db7f63/proxy/41461/status" target="_blank">/user/fc%3Auid%3Ac001c18e-88e2-449d-be62-663893db7f63/proxy/41461/status</a>
                    </td>
                    <td style="text-align: left;">
                        <strong>Total threads:</strong> 16
                    </td>
                </tr>
                <tr>
                    <td style="text-align: left;">
                        <strong>Started:</strong> Just now
                    </td>
                    <td style="text-align: left;">
                        <strong>Total memory:</strong> 16.00 GiB
                    </td>
                </tr>
            </table>
        </div>
    </div>

    <details style="margin-left: 48px;">
        <summary style="margin-bottom: 20px;">
            <h3 style="display: inline;">Workers</h3>
        </summary>

        
        <div style="margin-bottom: 20px;">
            <div style="width: 24px; height: 24px; background-color: #DBF5FF; border: 3px solid #4CC9FF; border-radius: 5px; position: absolute;"> </div>
            <div style="margin-left: 48px;">
            <details>
                <summary>
                    <h4 style="margin-bottom: 0px; display: inline;">Worker: 0</h4>
                </summary>
                <table style="width: 100%; text-align: left;">
                    <tr>
                        <td style="text-align: left;">
                            <strong>Comm: </strong> tcp://127.0.0.1:40965
                        </td>
                        <td style="text-align: left;">
                            <strong>Total threads: </strong> 4
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Dashboard: </strong> <a href="/user/fc%3Auid%3Ac001c18e-88e2-449d-be62-663893db7f63/proxy/35191/status" target="_blank">/user/fc%3Auid%3Ac001c18e-88e2-449d-be62-663893db7f63/proxy/35191/status</a>
                        </td>
                        <td style="text-align: left;">
                            <strong>Memory: </strong> 4.00 GiB
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Nanny: </strong> tcp://127.0.0.1:41991
                        </td>
                        <td style="text-align: left;"></td>
                    </tr>
                    <tr>
                        <td colspan="2" style="text-align: left;">
                            <strong>Local directory: </strong> /tmp/dask-scratch-space/worker-flktvsiq
                        </td>
                    </tr>

                    

                    

                </table>
            </details>
            </div>
        </div>
        
        <div style="margin-bottom: 20px;">
            <div style="width: 24px; height: 24px; background-color: #DBF5FF; border: 3px solid #4CC9FF; border-radius: 5px; position: absolute;"> </div>
            <div style="margin-left: 48px;">
            <details>
                <summary>
                    <h4 style="margin-bottom: 0px; display: inline;">Worker: 1</h4>
                </summary>
                <table style="width: 100%; text-align: left;">
                    <tr>
                        <td style="text-align: left;">
                            <strong>Comm: </strong> tcp://127.0.0.1:42531
                        </td>
                        <td style="text-align: left;">
                            <strong>Total threads: </strong> 4
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Dashboard: </strong> <a href="/user/fc%3Auid%3Ac001c18e-88e2-449d-be62-663893db7f63/proxy/36161/status" target="_blank">/user/fc%3Auid%3Ac001c18e-88e2-449d-be62-663893db7f63/proxy/36161/status</a>
                        </td>
                        <td style="text-align: left;">
                            <strong>Memory: </strong> 4.00 GiB
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Nanny: </strong> tcp://127.0.0.1:46387
                        </td>
                        <td style="text-align: left;"></td>
                    </tr>
                    <tr>
                        <td colspan="2" style="text-align: left;">
                            <strong>Local directory: </strong> /tmp/dask-scratch-space/worker-bh5r0czt
                        </td>
                    </tr>

                    

                    

                </table>
            </details>
            </div>
        </div>
        
        <div style="margin-bottom: 20px;">
            <div style="width: 24px; height: 24px; background-color: #DBF5FF; border: 3px solid #4CC9FF; border-radius: 5px; position: absolute;"> </div>
            <div style="margin-left: 48px;">
            <details>
                <summary>
                    <h4 style="margin-bottom: 0px; display: inline;">Worker: 2</h4>
                </summary>
                <table style="width: 100%; text-align: left;">
                    <tr>
                        <td style="text-align: left;">
                            <strong>Comm: </strong> tcp://127.0.0.1:35245
                        </td>
                        <td style="text-align: left;">
                            <strong>Total threads: </strong> 4
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Dashboard: </strong> <a href="/user/fc%3Auid%3Ac001c18e-88e2-449d-be62-663893db7f63/proxy/41291/status" target="_blank">/user/fc%3Auid%3Ac001c18e-88e2-449d-be62-663893db7f63/proxy/41291/status</a>
                        </td>
                        <td style="text-align: left;">
                            <strong>Memory: </strong> 4.00 GiB
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Nanny: </strong> tcp://127.0.0.1:45361
                        </td>
                        <td style="text-align: left;"></td>
                    </tr>
                    <tr>
                        <td colspan="2" style="text-align: left;">
                            <strong>Local directory: </strong> /tmp/dask-scratch-space/worker-fyxf1jwc
                        </td>
                    </tr>

                    

                    

                </table>
            </details>
            </div>
        </div>
        
        <div style="margin-bottom: 20px;">
            <div style="width: 24px; height: 24px; background-color: #DBF5FF; border: 3px solid #4CC9FF; border-radius: 5px; position: absolute;"> </div>
            <div style="margin-left: 48px;">
            <details>
                <summary>
                    <h4 style="margin-bottom: 0px; display: inline;">Worker: 3</h4>
                </summary>
                <table style="width: 100%; text-align: left;">
                    <tr>
                        <td style="text-align: left;">
                            <strong>Comm: </strong> tcp://127.0.0.1:33061
                        </td>
                        <td style="text-align: left;">
                            <strong>Total threads: </strong> 4
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Dashboard: </strong> <a href="/user/fc%3Auid%3Ac001c18e-88e2-449d-be62-663893db7f63/proxy/34863/status" target="_blank">/user/fc%3Auid%3Ac001c18e-88e2-449d-be62-663893db7f63/proxy/34863/status</a>
                        </td>
                        <td style="text-align: left;">
                            <strong>Memory: </strong> 4.00 GiB
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Nanny: </strong> tcp://127.0.0.1:38699
                        </td>
                        <td style="text-align: left;"></td>
                    </tr>
                    <tr>
                        <td colspan="2" style="text-align: left;">
                            <strong>Local directory: </strong> /tmp/dask-scratch-space/worker-akt_bedt
                        </td>
                    </tr>

                    

                    

                </table>
            </details>
            </div>
        </div>
        

    </details>
</div>

        </details>
    </div>
</div>
            </details>
        

    </div>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;/mnt/craas2-ns9988k/data/catalogs/&#39;</span><span class="p">)</span>
<span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;salsa_catalog.json&#39;</span><span class="p">)</span>
<span class="n">col</span> <span class="o">=</span> <span class="n">intake</span><span class="o">.</span><span class="n">open_esm_datastore</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">col</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><p><strong>salsa_cat catalog with 10 dataset(s) from 8928 asset(s)</strong>:</p> <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>unique</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>bin_index</th>
      <td>10</td>
    </tr>
    <tr>
      <th>variable</th>
      <td>93</td>
    </tr>
    <tr>
      <th>species</th>
      <td>7</td>
    </tr>
    <tr>
      <th>bin</th>
      <td>17</td>
    </tr>
    <tr>
      <th>category</th>
      <td>2</td>
    </tr>
    <tr>
      <th>soluble</th>
      <td>2</td>
    </tr>
    <tr>
      <th>unit</th>
      <td>3</td>
    </tr>
    <tr>
      <th>long_name</th>
      <td>93</td>
    </tr>
    <tr>
      <th>start_time</th>
      <td>96</td>
    </tr>
    <tr>
      <th>end_time</th>
      <td>96</td>
    </tr>
    <tr>
      <th>time_range</th>
      <td>96</td>
    </tr>
    <tr>
      <th>vertical_levels</th>
      <td>1</td>
    </tr>
    <tr>
      <th>path</th>
      <td>8928</td>
    </tr>
    <tr>
      <th>derived_variable</th>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>This provides an overview of what kind of data we are dealing with. For example there are two unique values for the attribute “soluble”, since it can only be either True or False. The bins are sorted into insoluble and soluble bins.</p>
<section id="salsa-aerosol-bin-structure">
<h2>SALSA aerosol bin structure<a class="headerlink" href="#salsa-aerosol-bin-structure" title="Link to this heading">#</a></h2>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Bin</p></th>
<th class="head text-center"><p>bin_index</p></th>
<th class="head text-center"><p>Species</p></th>
<th class="head text-center"><p>Soluble</p></th>
<th class="head text-center"><p>Center diameter (nm)</p></th>
<th class="head text-center"><p>Upper bound</p></th>
<th class="head text-center"><p>Lower bound</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>1a1</p></td>
<td class="text-center"><p>i1</p></td>
<td class="text-center"><p>H2SO4, OC</p></td>
<td class="text-center"><p>True</p></td>
<td class="text-center"><p>4.79</p></td>
<td class="text-center"><p>3.0</p></td>
<td class="text-center"><p>7.66</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>1a2</p></td>
<td class="text-center"><p>i2</p></td>
<td class="text-center"><p>H2SO4, OC</p></td>
<td class="text-center"><p>True</p></td>
<td class="text-center"><p>12.2</p></td>
<td class="text-center"><p>7.66</p></td>
<td class="text-center"><p>19.6</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>1a3</p></td>
<td class="text-center"><p>i3</p></td>
<td class="text-center"><p>H2SO4, OC</p></td>
<td class="text-center"><p>True</p></td>
<td class="text-center"><p>31.3</p></td>
<td class="text-center"><p>19.6</p></td>
<td class="text-center"><p>50.0</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>2a1</p></td>
<td class="text-center"><p>i4</p></td>
<td class="text-center"><p>H2SO4, DU, OC, SS, BC</p></td>
<td class="text-center"><p>True</p></td>
<td class="text-center"><p>69.5</p></td>
<td class="text-center"><p>50.0</p></td>
<td class="text-center"><p>96.7</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>2a2</p></td>
<td class="text-center"><p>i5</p></td>
<td class="text-center"><p>H2SO4, DU, OC, SS, BC</p></td>
<td class="text-center"><p>True</p></td>
<td class="text-center"><p>135.0</p></td>
<td class="text-center"><p>96.7</p></td>
<td class="text-center"><p>187.0</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>2a3</p></td>
<td class="text-center"><p>i6</p></td>
<td class="text-center"><p>H2SO4, DU, OC, SS, BC</p></td>
<td class="text-center"><p>True</p></td>
<td class="text-center"><p>260.0</p></td>
<td class="text-center"><p>187.0</p></td>
<td class="text-center"><p>362.0</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>2a4</p></td>
<td class="text-center"><p>i7</p></td>
<td class="text-center"><p>H2SO4, DU, OC, SS, BC</p></td>
<td class="text-center"><p>True</p></td>
<td class="text-center"><p>503.0</p></td>
<td class="text-center"><p>362.0</p></td>
<td class="text-center"><p>700.0</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>2a5</p></td>
<td class="text-center"><p>i8</p></td>
<td class="text-center"><p>H2SO4, DU, OC, SS, BC</p></td>
<td class="text-center"><p>True</p></td>
<td class="text-center"><p>1090.0</p></td>
<td class="text-center"><p>700.0</p></td>
<td class="text-center"><p>1700.0</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>2a6</p></td>
<td class="text-center"><p>i9</p></td>
<td class="text-center"><p>H2SO4, DU, OC, SS, BC</p></td>
<td class="text-center"><p>True</p></td>
<td class="text-center"><p>2650.0</p></td>
<td class="text-center"><p>1700.0</p></td>
<td class="text-center"><p>4120.0</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>2a7</p></td>
<td class="text-center"><p>i10</p></td>
<td class="text-center"><p>H2SO4, DU, OC, SS, BC</p></td>
<td class="text-center"><p>True</p></td>
<td class="text-center"><p>6420.0</p></td>
<td class="text-center"><p>4120.0</p></td>
<td class="text-center"><p>10000.0</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>2b1</p></td>
<td class="text-center"><p>i4</p></td>
<td class="text-center"><p>H2SO4, DU, OC, BC</p></td>
<td class="text-center"><p>False</p></td>
<td class="text-center"><p>69.5</p></td>
<td class="text-center"><p>50.0</p></td>
<td class="text-center"><p>96.7</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>2b2</p></td>
<td class="text-center"><p>i5</p></td>
<td class="text-center"><p>H2SO4, DU, OC, BC</p></td>
<td class="text-center"><p>False</p></td>
<td class="text-center"><p>135.0</p></td>
<td class="text-center"><p>96.7</p></td>
<td class="text-center"><p>187.0</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>2b3</p></td>
<td class="text-center"><p>i6</p></td>
<td class="text-center"><p>H2SO4, DU, OC, BC</p></td>
<td class="text-center"><p>False</p></td>
<td class="text-center"><p>260.0</p></td>
<td class="text-center"><p>187.0</p></td>
<td class="text-center"><p>362.0</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>2b4</p></td>
<td class="text-center"><p>i7</p></td>
<td class="text-center"><p>H2SO4, DU, OC, BC</p></td>
<td class="text-center"><p>False</p></td>
<td class="text-center"><p>503.0</p></td>
<td class="text-center"><p>362.0</p></td>
<td class="text-center"><p>700.0</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>2b5</p></td>
<td class="text-center"><p>i8</p></td>
<td class="text-center"><p>H2SO4, DU, OC, BC</p></td>
<td class="text-center"><p>False</p></td>
<td class="text-center"><p>1090.0</p></td>
<td class="text-center"><p>700.0</p></td>
<td class="text-center"><p>1700.0</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>2b6</p></td>
<td class="text-center"><p>i9</p></td>
<td class="text-center"><p>H2SO4, DU, OC, BC</p></td>
<td class="text-center"><p>False</p></td>
<td class="text-center"><p>2650.0</p></td>
<td class="text-center"><p>1700.0</p></td>
<td class="text-center"><p>4120.0</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>2b7</p></td>
<td class="text-center"><p>i10</p></td>
<td class="text-center"><p>H2SO4, DU, OC, BC</p></td>
<td class="text-center"><p>False</p></td>
<td class="text-center"><p>6420.0</p></td>
<td class="text-center"><p>4120.0</p></td>
<td class="text-center"><p>10000.0</p></td>
</tr>
</tbody>
</table>
</div>
<p>H2SO4 is sulfate aerosol, DU is mineral dust, OC is organic carbon, and SS is sea spray.
There are three size groups for aerosol in ECHAM-SALSA. 1a: The smallest bin range, only contains Sulfate and is considered soluble. 2a: The larger soluble range, which contains all aerosol species. 2b: The larger insoluble range, which also contains all aerosols. The bin index is the same for the soluble/insoluble bins in the larger range.</p>
<p>NOTE: The bin_index attribute is not an official naming. If you use this for plotting later, it might be worth using radii or the original bin names instead.</p>
</section>
<section id="data-subsets">
<h2>Data subsets<a class="headerlink" href="#data-subsets" title="Link to this heading">#</a></h2>
<p>Select for a specific time period or species with <em>search</em>. To check out, what species are available, we can use <em>.unique()</em>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">col</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;species&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;bc&#39;, &#39;conccn&#39;, &#39;du&#39;, &#39;h2so4&#39;, &#39;mmrtr&#39;, &#39;oc&#39;, &#39;ss&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cat</span> <span class="o">=</span> <span class="n">col</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">species</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;bc&#39;</span><span class="p">,</span><span class="s1">&#39;du&#39;</span><span class="p">,</span><span class="s1">&#39;ss&#39;</span><span class="p">,</span><span class="s1">&#39;h2so4&#39;</span><span class="p">,</span><span class="s1">&#39;oc&#39;</span><span class="p">],</span> <span class="c1">#, now we get only the mass mixing ratios for all species</span>
                 <span class="n">vertical_coord</span><span class="o">=</span><span class="s1">&#39;pressure&#39;</span> <span class="c1"># or &#39;hybrid&#39; if you are fancy. This is only up to ~200hPa</span>
                <span class="c1">#start_time=[&quot;2012-01-01&quot;],</span>
				<span class="c1">#bin_index= [&quot;i1&quot;],</span>
				<span class="c1">#variable = [&quot;h2so4_1a1&quot;],</span>
				<span class="c1">#bin = [&quot;1a1&quot;],</span>
				<span class="c1">#soluble = [True&#39;],</span>
				<span class="c1">#unit = [&#39;kg/kg&#39;]</span>
                <span class="p">)</span>
<span class="n">cat</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><p><strong>salsa_cat catalog with 10 dataset(s) from 4320 asset(s)</strong>:</p> <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>unique</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>bin_index</th>
      <td>10</td>
    </tr>
    <tr>
      <th>variable</th>
      <td>45</td>
    </tr>
    <tr>
      <th>species</th>
      <td>4</td>
    </tr>
    <tr>
      <th>bin</th>
      <td>17</td>
    </tr>
    <tr>
      <th>category</th>
      <td>1</td>
    </tr>
    <tr>
      <th>soluble</th>
      <td>2</td>
    </tr>
    <tr>
      <th>unit</th>
      <td>1</td>
    </tr>
    <tr>
      <th>long_name</th>
      <td>45</td>
    </tr>
    <tr>
      <th>start_time</th>
      <td>96</td>
    </tr>
    <tr>
      <th>end_time</th>
      <td>96</td>
    </tr>
    <tr>
      <th>time_range</th>
      <td>96</td>
    </tr>
    <tr>
      <th>vertical_levels</th>
      <td>1</td>
    </tr>
    <tr>
      <th>path</th>
      <td>4320</td>
    </tr>
    <tr>
      <th>derived_variable</th>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cat</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;species&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;du&#39;, &#39;h2so4&#39;, &#39;oc&#39;, &#39;ss&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
</section>
<section id="create-a-dictionary">
<h2>Create a dictionary<a class="headerlink" href="#create-a-dictionary" title="Link to this heading">#</a></h2>
<p>Now we can create a dictionary of the datasets we have selected. This will automatically aggregate the selected time steps. For this step, you usually need Dask (activated above) and it might take a couple of minutes, depending on how much data you have selected.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dset_dict</span> <span class="o">=</span> <span class="n">cat</span><span class="o">.</span><span class="n">to_dataset_dict</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--&gt; The keys in the returned dictionary of datasets are constructed as follows:
	&#39;bin_index&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/envs/pangeo-notebook/lib/python3.11/site-packages/intake_esm/core.py:253: FutureWarning: When grouping with a length-1 list-like, you will need to pass a length-1 tuple to get_group in a future version of pandas. Pass `(name,)` instead of `name` to silence this warning.
  records = grouped.get_group(internal_key).to_dict(orient=&#39;records&#39;)
/opt/conda/envs/pangeo-notebook/lib/python3.11/site-packages/intake_esm/core.py:253: FutureWarning: When grouping with a length-1 list-like, you will need to pass a length-1 tuple to get_group in a future version of pandas. Pass `(name,)` instead of `name` to silence this warning.
  records = grouped.get_group(internal_key).to_dict(orient=&#39;records&#39;)
/opt/conda/envs/pangeo-notebook/lib/python3.11/site-packages/intake_esm/core.py:253: FutureWarning: When grouping with a length-1 list-like, you will need to pass a length-1 tuple to get_group in a future version of pandas. Pass `(name,)` instead of `name` to silence this warning.
  records = grouped.get_group(internal_key).to_dict(orient=&#39;records&#39;)
/opt/conda/envs/pangeo-notebook/lib/python3.11/site-packages/intake_esm/core.py:253: FutureWarning: When grouping with a length-1 list-like, you will need to pass a length-1 tuple to get_group in a future version of pandas. Pass `(name,)` instead of `name` to silence this warning.
  records = grouped.get_group(internal_key).to_dict(orient=&#39;records&#39;)
/opt/conda/envs/pangeo-notebook/lib/python3.11/site-packages/intake_esm/core.py:253: FutureWarning: When grouping with a length-1 list-like, you will need to pass a length-1 tuple to get_group in a future version of pandas. Pass `(name,)` instead of `name` to silence this warning.
  records = grouped.get_group(internal_key).to_dict(orient=&#39;records&#39;)
/opt/conda/envs/pangeo-notebook/lib/python3.11/site-packages/intake_esm/core.py:253: FutureWarning: When grouping with a length-1 list-like, you will need to pass a length-1 tuple to get_group in a future version of pandas. Pass `(name,)` instead of `name` to silence this warning.
  records = grouped.get_group(internal_key).to_dict(orient=&#39;records&#39;)
/opt/conda/envs/pangeo-notebook/lib/python3.11/site-packages/intake_esm/core.py:253: FutureWarning: When grouping with a length-1 list-like, you will need to pass a length-1 tuple to get_group in a future version of pandas. Pass `(name,)` instead of `name` to silence this warning.
  records = grouped.get_group(internal_key).to_dict(orient=&#39;records&#39;)
/opt/conda/envs/pangeo-notebook/lib/python3.11/site-packages/intake_esm/core.py:253: FutureWarning: When grouping with a length-1 list-like, you will need to pass a length-1 tuple to get_group in a future version of pandas. Pass `(name,)` instead of `name` to silence this warning.
  records = grouped.get_group(internal_key).to_dict(orient=&#39;records&#39;)
/opt/conda/envs/pangeo-notebook/lib/python3.11/site-packages/intake_esm/core.py:253: FutureWarning: When grouping with a length-1 list-like, you will need to pass a length-1 tuple to get_group in a future version of pandas. Pass `(name,)` instead of `name` to silence this warning.
  records = grouped.get_group(internal_key).to_dict(orient=&#39;records&#39;)
/opt/conda/envs/pangeo-notebook/lib/python3.11/site-packages/intake_esm/core.py:253: FutureWarning: When grouping with a length-1 list-like, you will need to pass a length-1 tuple to get_group in a future version of pandas. Pass `(name,)` instead of `name` to silence this warning.
  records = grouped.get_group(internal_key).to_dict(orient=&#39;records&#39;)
</pre></div>
</div>
<div class="output text_html">
<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div><div class="output text_html">
    <div>
      <progress value='10' class='' max='10' style='width:300px; height:20px; vertical-align: middle;'></progress>
      100.00% [10/10 03:50&lt;00:00]
    </div>
    </div></div>
</div>
<p>The keys for the dictionary are the bin_index values. We can adapt this if a different data structure is more useful for your analysis (e.g. have the bins as keys instead of the bin_index). You may want to convert from hybrid coordinates to pressure coordinates. Information on how this is done is in the <a class="reference external" href="https://metos-uio.github.io/eScience2025/learning/notebooks/interpolate_hybridsigma2pressure_coords/">documentation</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dset_dict</span><span class="p">[</span><span class="s1">&#39;i1&#39;</span><span class="p">]</span> <span class="c1"># check out the smallest bin</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 66MB
Dimensions:    (time: 23376, ncells: 15, lev: 47, nhyi: 48, nhym: 47)
Coordinates:
  * time       (time) datetime64[ns] 187kB 2012-01-01T02:52:30 ... 2019-12-31...
    lon        (ncells) float64 120B dask.array&lt;chunksize=(15,), meta=np.ndarray&gt;
    lat        (ncells) float64 120B dask.array&lt;chunksize=(15,), meta=np.ndarray&gt;
  * lev        (lev) float64 376B 1.0 2.0 3.0 4.0 5.0 ... 44.0 45.0 46.0 47.0
    hyai       (nhyi) float64 384B dask.array&lt;chunksize=(48,), meta=np.ndarray&gt;
    hybi       (nhyi) float64 384B dask.array&lt;chunksize=(48,), meta=np.ndarray&gt;
    hyam       (nhym) float64 376B dask.array&lt;chunksize=(47,), meta=np.ndarray&gt;
    hybm       (nhym) float64 376B dask.array&lt;chunksize=(47,), meta=np.ndarray&gt;
Dimensions without coordinates: ncells, nhyi, nhym
Data variables:
    h2so4_1a1  (time, lev, ncells) float32 66MB dask.array&lt;chunksize=(248, 47, 15), meta=np.ndarray&gt;
Attributes: (12/24)
    CDI:                               Climate Data Interface version 2.0.5 (...
    Conventions:                       CF-1.4
    title:                             SALSA_GlobalTraj-PRECIP
    echam_version:                     6.3.02
    advection:                         Lin &amp; Rood
    physics:                           Modified ECMWF physics
    ...                                ...
    intake_esm_attrs:soluble:          True
    intake_esm_attrs:unit:             kg/kg
    intake_esm_attrs:long_name:        sulfuric acid 1a1
    intake_esm_attrs:vertical_levels:  47
    intake_esm_attrs:_data_format_:    netcdf
    intake_esm_dataset_key:            i1</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-ba80d482-271a-43df-a422-f2a46177dc3b' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-ba80d482-271a-43df-a422-f2a46177dc3b' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 23376</li><li><span>ncells</span>: 15</li><li><span class='xr-has-index'>lev</span>: 47</li><li><span>nhyi</span>: 48</li><li><span>nhym</span>: 47</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-213df45a-8d2b-4478-9686-7ad940b6f5cf' class='xr-section-summary-in' type='checkbox'  checked><label for='section-213df45a-8d2b-4478-9686-7ad940b6f5cf' class='xr-section-summary' >Coordinates: <span>(8)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2012-01-01T02:52:30 ... 2019-12-...</div><input id='attrs-5da1f0ce-5e4a-4b7a-bdbc-2df3482b1c7f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-5da1f0ce-5e4a-4b7a-bdbc-2df3482b1c7f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8177270a-017d-4dbe-a8e8-061182e87d99' class='xr-var-data-in' type='checkbox'><label for='data-8177270a-017d-4dbe-a8e8-061182e87d99' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>axis :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2012-01-01T02:52:30.000000000&#x27;, &#x27;2012-01-01T05:52:30.000000000&#x27;,
       &#x27;2012-01-01T08:52:30.000000000&#x27;, ..., &#x27;2019-12-31T17:52:30.000000000&#x27;,
       &#x27;2019-12-31T20:52:30.000000000&#x27;, &#x27;2019-12-31T23:52:30.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lon</span></div><div class='xr-var-dims'>(ncells)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(15,), meta=np.ndarray&gt;</div><input id='attrs-961c9fc7-7e4a-4e72-956e-820eab24caef' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-961c9fc7-7e4a-4e72-956e-820eab24caef' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c47fc01d-de74-4401-907c-7c11b0fbc8b9' class='xr-var-data-in' type='checkbox'><label for='data-c47fc01d-de74-4401-907c-7c11b0fbc8b9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 120 B </td>
                        <td> 120 B </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (15,) </td>
                        <td> (15,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 475 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="86" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="36" x2="120" y2="36" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="36" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="36" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,36.24782989210401 0.0,36.24782989210401" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="56.247830" font-size="1.0rem" font-weight="100" text-anchor="middle" >15</text>
  <text x="140.000000" y="18.123915" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,18.123915)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lat</span></div><div class='xr-var-dims'>(ncells)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(15,), meta=np.ndarray&gt;</div><input id='attrs-e093d330-0ef7-4d38-8abf-003a1bd6546a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-e093d330-0ef7-4d38-8abf-003a1bd6546a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2ded82d7-5f42-4fb0-895f-a7135ea7a5b1' class='xr-var-data-in' type='checkbox'><label for='data-2ded82d7-5f42-4fb0-895f-a7135ea7a5b1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 120 B </td>
                        <td> 120 B </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (15,) </td>
                        <td> (15,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 475 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="86" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="36" x2="120" y2="36" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="36" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="36" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,36.24782989210401 0.0,36.24782989210401" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="56.247830" font-size="1.0rem" font-weight="100" text-anchor="middle" >15</text>
  <text x="140.000000" y="18.123915" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,18.123915)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lev</span></div><div class='xr-var-dims'>(lev)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.0 2.0 3.0 4.0 ... 45.0 46.0 47.0</div><input id='attrs-d193f255-ee64-41ba-a386-e5381d6eaf9c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d193f255-ee64-41ba-a386-e5381d6eaf9c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f176619f-44dd-4c6f-86ec-6e5860d764e3' class='xr-var-data-in' type='checkbox'><label for='data-f176619f-44dd-4c6f-86ec-6e5860d764e3' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>hybrid_sigma_pressure</dd><dt><span>long_name :</span></dt><dd>hybrid level at layer midpoints</dd><dt><span>formula :</span></dt><dd>hyam hybm (mlev=hyam+hybm*aps)</dd><dt><span>formula_terms :</span></dt><dd>ap: hyam b: hybm ps: aps</dd><dt><span>units :</span></dt><dd>level</dd><dt><span>positive :</span></dt><dd>down</dd></dl></div><div class='xr-var-data'><pre>array([ 1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12., 13., 14.,
       15., 16., 17., 18., 19., 20., 21., 22., 23., 24., 25., 26., 27., 28.,
       29., 30., 31., 32., 33., 34., 35., 36., 37., 38., 39., 40., 41., 42.,
       43., 44., 45., 46., 47.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>hyai</span></div><div class='xr-var-dims'>(nhyi)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(48,), meta=np.ndarray&gt;</div><input id='attrs-57891f40-45c3-4bf5-9f97-87a8ca099a9a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-57891f40-45c3-4bf5-9f97-87a8ca099a9a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-67027979-47b1-4243-8d29-5d9452f7b309' class='xr-var-data-in' type='checkbox'><label for='data-67027979-47b1-4243-8d29-5d9452f7b309' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>hybrid A coefficient at layer interfaces</dd><dt><span>units :</span></dt><dd>Pa</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 384 B </td>
                        <td> 384 B </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (48,) </td>
                        <td> (48,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 475 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="79" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="29" x2="120" y2="29" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="29" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="29" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,29.2612335534925 0.0,29.2612335534925" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="49.261234" font-size="1.0rem" font-weight="100" text-anchor="middle" >48</text>
  <text x="140.000000" y="14.630617" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,14.630617)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>hybi</span></div><div class='xr-var-dims'>(nhyi)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(48,), meta=np.ndarray&gt;</div><input id='attrs-a8851980-3802-4761-acac-2f331661833e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a8851980-3802-4761-acac-2f331661833e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-af3d1812-b1ed-41ab-80f0-96623217b50e' class='xr-var-data-in' type='checkbox'><label for='data-af3d1812-b1ed-41ab-80f0-96623217b50e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>hybrid B coefficient at layer interfaces</dd><dt><span>units :</span></dt><dd>1</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 384 B </td>
                        <td> 384 B </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (48,) </td>
                        <td> (48,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 475 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="79" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="29" x2="120" y2="29" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="29" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="29" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,29.2612335534925 0.0,29.2612335534925" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="49.261234" font-size="1.0rem" font-weight="100" text-anchor="middle" >48</text>
  <text x="140.000000" y="14.630617" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,14.630617)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>hyam</span></div><div class='xr-var-dims'>(nhym)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(47,), meta=np.ndarray&gt;</div><input id='attrs-dfaa3442-614f-447b-bf67-e7e74e49976d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-dfaa3442-614f-447b-bf67-e7e74e49976d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-45cbabe0-bc2f-4df3-bfac-46479a7803c4' class='xr-var-data-in' type='checkbox'><label for='data-45cbabe0-bc2f-4df3-bfac-46479a7803c4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>hybrid A coefficient at layer midpoints</dd><dt><span>units :</span></dt><dd>Pa</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 376 B </td>
                        <td> 376 B </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (47,) </td>
                        <td> (47,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 475 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="79" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="29" x2="120" y2="29" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="29" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="29" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,29.38084118065451 0.0,29.38084118065451" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="49.380841" font-size="1.0rem" font-weight="100" text-anchor="middle" >47</text>
  <text x="140.000000" y="14.690421" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,14.690421)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>hybm</span></div><div class='xr-var-dims'>(nhym)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(47,), meta=np.ndarray&gt;</div><input id='attrs-4b70361e-c6ef-43ad-95ef-999d66dfb312' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-4b70361e-c6ef-43ad-95ef-999d66dfb312' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-585a6c4b-4917-4e10-ae71-b33fb329e869' class='xr-var-data-in' type='checkbox'><label for='data-585a6c4b-4917-4e10-ae71-b33fb329e869' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>hybrid B coefficient at layer midpoints</dd><dt><span>units :</span></dt><dd>1</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 376 B </td>
                        <td> 376 B </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (47,) </td>
                        <td> (47,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 475 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="79" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="29" x2="120" y2="29" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="29" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="29" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,29.38084118065451 0.0,29.38084118065451" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="49.380841" font-size="1.0rem" font-weight="100" text-anchor="middle" >47</text>
  <text x="140.000000" y="14.690421" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,14.690421)">1</text>
</svg>
        </td>
    </tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-49833160-dd5d-4075-a633-184137f4c218' class='xr-section-summary-in' type='checkbox'  checked><label for='section-49833160-dd5d-4075-a633-184137f4c218' class='xr-section-summary' >Data variables: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>h2so4_1a1</span></div><div class='xr-var-dims'>(time, lev, ncells)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(248, 47, 15), meta=np.ndarray&gt;</div><input id='attrs-251ec38a-e21c-49e1-9592-2c2ae2f5a71b' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-251ec38a-e21c-49e1-9592-2c2ae2f5a71b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d20ca9b6-27f8-418e-9ae5-f7bba7c52a81' class='xr-var-data-in' type='checkbox'><label for='data-d20ca9b6-27f8-418e-9ae5-f7bba7c52a81' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>sulfuric acid 1a1</dd><dt><span>units :</span></dt><dd>kg/kg</dd><dt><span>CDI_grid_type :</span></dt><dd>unstructured</dd><dt><span>description :</span></dt><dd>mass_fraction_of_sulfuric_acid_dry_aerosol_in_air_1a1</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 62.87 MiB </td>
                        <td> 682.97 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (23376, 47, 15) </td>
                        <td> (248, 47, 15) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 96 chunks in 193 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="156" height="146" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="25" x2="80" y2="96" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="25" style="stroke-width:2" />
  <line x1="13" y1="3" x2="13" y2="29" />
  <line x1="17" y1="7" x2="17" y2="32" />
  <line x1="21" y1="11" x2="21" y2="36" />
  <line x1="24" y1="14" x2="24" y2="40" />
  <line x1="28" y1="18" x2="28" y2="43" />
  <line x1="32" y1="22" x2="32" y2="47" />
  <line x1="35" y1="25" x2="35" y2="51" />
  <line x1="39" y1="29" x2="39" y2="54" />
  <line x1="43" y1="33" x2="43" y2="58" />
  <line x1="46" y1="36" x2="46" y2="62" />
  <line x1="50" y1="40" x2="50" y2="65" />
  <line x1="54" y1="44" x2="54" y2="69" />
  <line x1="57" y1="47" x2="57" y2="73" />
  <line x1="61" y1="51" x2="61" y2="76" />
  <line x1="65" y1="55" x2="65" y2="80" />
  <line x1="68" y1="58" x2="68" y2="84" />
  <line x1="72" y1="62" x2="72" y2="87" />
  <line x1="76" y1="66" x2="76" y2="91" />
  <line x1="80" y1="70" x2="80" y2="96" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,96.00085180870013 10.0,25.412616514582485" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="35" y2="0" style="stroke-width:2" />
  <line x1="13" y1="3" x2="39" y2="3" />
  <line x1="17" y1="7" x2="42" y2="7" />
  <line x1="21" y1="11" x2="46" y2="11" />
  <line x1="24" y1="14" x2="50" y2="14" />
  <line x1="28" y1="18" x2="53" y2="18" />
  <line x1="32" y1="22" x2="57" y2="22" />
  <line x1="35" y1="25" x2="61" y2="25" />
  <line x1="39" y1="29" x2="64" y2="29" />
  <line x1="43" y1="33" x2="68" y2="33" />
  <line x1="46" y1="36" x2="72" y2="36" />
  <line x1="50" y1="40" x2="75" y2="40" />
  <line x1="54" y1="44" x2="79" y2="44" />
  <line x1="57" y1="47" x2="83" y2="47" />
  <line x1="61" y1="51" x2="86" y2="51" />
  <line x1="65" y1="55" x2="90" y2="55" />
  <line x1="68" y1="58" x2="94" y2="58" />
  <line x1="72" y1="62" x2="97" y2="62" />
  <line x1="76" y1="66" x2="101" y2="66" />
  <line x1="80" y1="70" x2="106" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="35" y1="0" x2="106" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 35.41261651458248,0.0 106.00085180870013,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="106" y2="70" style="stroke-width:2" />
  <line x1="80" y1="96" x2="106" y2="96" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="96" style="stroke-width:2" />
  <line x1="106" y1="70" x2="106" y2="96" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 106.00085180870013,70.58823529411765 106.00085180870013,96.00085180870013 80.58823529411765,96.00085180870013" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="93.294544" y="116.000852" font-size="1.0rem" font-weight="100" text-anchor="middle" >15</text>
  <text x="126.000852" y="83.294544" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,126.000852,83.294544)">47</text>
  <text x="35.294118" y="80.706734" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,80.706734)">23376</text>
</svg>
        </td>
    </tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-91de7d29-dde4-4443-9adc-a8f9fe4f8836' class='xr-section-summary-in' type='checkbox'  ><label for='section-91de7d29-dde4-4443-9adc-a8f9fe4f8836' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-d2af3fa4-1f7f-41ba-b9dd-c2d1e1bf2bf4' class='xr-index-data-in' type='checkbox'/><label for='index-d2af3fa4-1f7f-41ba-b9dd-c2d1e1bf2bf4' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2012-01-01 02:52:30&#x27;, &#x27;2012-01-01 05:52:30&#x27;,
               &#x27;2012-01-01 08:52:30&#x27;, &#x27;2012-01-01 11:52:30&#x27;,
               &#x27;2012-01-01 14:52:30&#x27;, &#x27;2012-01-01 17:52:30&#x27;,
               &#x27;2012-01-01 20:52:30&#x27;, &#x27;2012-01-01 23:52:30&#x27;,
               &#x27;2012-01-02 02:52:30&#x27;, &#x27;2012-01-02 05:52:30&#x27;,
               ...
               &#x27;2019-12-30 20:52:30&#x27;, &#x27;2019-12-30 23:52:30&#x27;,
               &#x27;2019-12-31 02:52:30&#x27;, &#x27;2019-12-31 05:52:30&#x27;,
               &#x27;2019-12-31 08:52:30&#x27;, &#x27;2019-12-31 11:52:30&#x27;,
               &#x27;2019-12-31 14:52:30&#x27;, &#x27;2019-12-31 17:52:30&#x27;,
               &#x27;2019-12-31 20:52:30&#x27;, &#x27;2019-12-31 23:52:30&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=23376, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lev</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-1ac42dbd-8664-4db3-9058-930f6f0dec48' class='xr-index-data-in' type='checkbox'/><label for='index-1ac42dbd-8664-4db3-9058-930f6f0dec48' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ 1.0,  2.0,  3.0,  4.0,  5.0,  6.0,  7.0,  8.0,  9.0, 10.0, 11.0, 12.0,
       13.0, 14.0, 15.0, 16.0, 17.0, 18.0, 19.0, 20.0, 21.0, 22.0, 23.0, 24.0,
       25.0, 26.0, 27.0, 28.0, 29.0, 30.0, 31.0, 32.0, 33.0, 34.0, 35.0, 36.0,
       37.0, 38.0, 39.0, 40.0, 41.0, 42.0, 43.0, 44.0, 45.0, 46.0, 47.0],
      dtype=&#x27;float64&#x27;, name=&#x27;lev&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-8b4df0b4-cd27-4eac-9cd1-5561d14c32d0' class='xr-section-summary-in' type='checkbox'  ><label for='section-8b4df0b4-cd27-4eac-9cd1-5561d14c32d0' class='xr-section-summary' >Attributes: <span>(24)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>CDI :</span></dt><dd>Climate Data Interface version 2.0.5 (https://mpimet.mpg.de/cdi)</dd><dt><span>Conventions :</span></dt><dd>CF-1.4</dd><dt><span>title :</span></dt><dd>SALSA_GlobalTraj-PRECIP</dd><dt><span>echam_version :</span></dt><dd>6.3.02</dd><dt><span>advection :</span></dt><dd>Lin &amp; Rood</dd><dt><span>physics :</span></dt><dd>Modified ECMWF physics</dd><dt><span>radiation :</span></dt><dd>Using PSrad/RRTMG radiation</dd><dt><span>operating_system :</span></dt><dd>Linux 4.18.0-372.105.1.csc1.el8_6.x86_64 x86_64</dd><dt><span>user_name :</span></dt><dd>Muhammed Irfan (mirfan)</dd><dt><span>jsbach_version :</span></dt><dd>3.10</dd><dt><span>truncation :</span></dt><dd>63</dd><dt><span>CDO :</span></dt><dd>Climate Data Operators version 2.0.5 (https://mpimet.mpg.de/cdo)</dd><dt><span>intake_esm_vars :</span></dt><dd>[&#x27;h2so4_1a1&#x27;]</dd><dt><span>intake_esm_attrs:bin_index :</span></dt><dd>i1</dd><dt><span>intake_esm_attrs:variable :</span></dt><dd>h2so4_1a1</dd><dt><span>intake_esm_attrs:species :</span></dt><dd>h2so4</dd><dt><span>intake_esm_attrs:bin :</span></dt><dd>1a1</dd><dt><span>intake_esm_attrs:category :</span></dt><dd>species_mmr</dd><dt><span>intake_esm_attrs:soluble :</span></dt><dd>True</dd><dt><span>intake_esm_attrs:unit :</span></dt><dd>kg/kg</dd><dt><span>intake_esm_attrs:long_name :</span></dt><dd>sulfuric acid 1a1</dd><dt><span>intake_esm_attrs:vertical_levels :</span></dt><dd>47</dd><dt><span>intake_esm_attrs:_data_format_ :</span></dt><dd>netcdf</dd><dt><span>intake_esm_dataset_key :</span></dt><dd>i1</dd></dl></div></li></ul></div></div></div></div>
</div>
</section>
<section id="station-names">
<h2>Station names<a class="headerlink" href="#station-names" title="Link to this heading">#</a></h2>
<p>The data we have is collocated with measuring stations. Currently the dimension ncells describes the lat-lon location. We can replace this with the actual station names.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># read the csv with station information</span>
<span class="n">station_file</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/mnt/craas2-ns9988k-dl-ns9560k/chrisvbr/ECHAM-SALSA-data/locations.csv&#39;</span><span class="p">,</span> <span class="n">delimiter</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">names</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">station_file</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

<span class="c1"># replace ncells with station names</span>
<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">dset_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="n">dset_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">dset_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;ncells&#39;</span><span class="p">:</span> <span class="s1">&#39;station&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">reset_coords</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">dset_dict</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;station&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;station&#39;</span><span class="p">,</span> <span class="n">names</span><span class="p">)</span>
<span class="n">dset_dict</span><span class="p">[</span><span class="s1">&#39;i1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">station</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;station&#x27; (station: 15)&gt; Size: 120B
array([&#x27;ZEP&#x27;, &#x27;SMR-II&#x27;, &#x27;ATTO&#x27;, &#x27;MHD&#x27;, &#x27;SGP&#x27;, &#x27;CHC&#x27;, &#x27;BIR-II&#x27;, &#x27;PAL&#x27;,
       &#x27;Vavihill&#x27;, &#x27;JFJ&#x27;, &#x27;FKL&#x27;, &#x27;SMEAR-I&#x27;, &#x27;Villum&#x27;, &#x27;Izana&#x27;, &#x27;Maldives&#x27;],
      dtype=object)
Coordinates:
  * station  (station) object 120B &#x27;ZEP&#x27; &#x27;SMR-II&#x27; &#x27;ATTO&#x27; ... &#x27;Izana&#x27; &#x27;Maldives&#x27;</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'station'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>station</span>: 15</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-46d77bf1-056c-4862-9f6c-45b9fe4f4fcc' class='xr-array-in' type='checkbox' checked><label for='section-46d77bf1-056c-4862-9f6c-45b9fe4f4fcc' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>&#x27;ZEP&#x27; &#x27;SMR-II&#x27; &#x27;ATTO&#x27; &#x27;MHD&#x27; ... &#x27;SMEAR-I&#x27; &#x27;Villum&#x27; &#x27;Izana&#x27; &#x27;Maldives&#x27;</span></div><div class='xr-array-data'><pre>array([&#x27;ZEP&#x27;, &#x27;SMR-II&#x27;, &#x27;ATTO&#x27;, &#x27;MHD&#x27;, &#x27;SGP&#x27;, &#x27;CHC&#x27;, &#x27;BIR-II&#x27;, &#x27;PAL&#x27;,
       &#x27;Vavihill&#x27;, &#x27;JFJ&#x27;, &#x27;FKL&#x27;, &#x27;SMEAR-I&#x27;, &#x27;Villum&#x27;, &#x27;Izana&#x27;, &#x27;Maldives&#x27;],
      dtype=object)</pre></div></div></li><li class='xr-section-item'><input id='section-a613a9da-4bbb-4aef-87a0-007650ef059e' class='xr-section-summary-in' type='checkbox'  checked><label for='section-a613a9da-4bbb-4aef-87a0-007650ef059e' class='xr-section-summary' >Coordinates: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>station</span></div><div class='xr-var-dims'>(station)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>&#x27;ZEP&#x27; &#x27;SMR-II&#x27; ... &#x27;Maldives&#x27;</div><input id='attrs-35d073d4-9236-4d3a-8ad3-272ad1dee8df' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-35d073d4-9236-4d3a-8ad3-272ad1dee8df' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6b0073d4-9c46-410e-acc4-a7afe835bc68' class='xr-var-data-in' type='checkbox'><label for='data-6b0073d4-9c46-410e-acc4-a7afe835bc68' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;ZEP&#x27;, &#x27;SMR-II&#x27;, &#x27;ATTO&#x27;, &#x27;MHD&#x27;, &#x27;SGP&#x27;, &#x27;CHC&#x27;, &#x27;BIR-II&#x27;, &#x27;PAL&#x27;,
       &#x27;Vavihill&#x27;, &#x27;JFJ&#x27;, &#x27;FKL&#x27;, &#x27;SMEAR-I&#x27;, &#x27;Villum&#x27;, &#x27;Izana&#x27;, &#x27;Maldives&#x27;],
      dtype=object)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-bdd55236-1d47-47a7-8534-6adf24f64ebc' class='xr-section-summary-in' type='checkbox'  ><label for='section-bdd55236-1d47-47a7-8534-6adf24f64ebc' class='xr-section-summary' >Indexes: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>station</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-73887294-f083-4b08-a17e-0780f5e06515' class='xr-index-data-in' type='checkbox'/><label for='index-73887294-f083-4b08-a17e-0780f5e06515' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;ZEP&#x27;, &#x27;SMR-II&#x27;, &#x27;ATTO&#x27;, &#x27;MHD&#x27;, &#x27;SGP&#x27;, &#x27;CHC&#x27;, &#x27;BIR-II&#x27;, &#x27;PAL&#x27;,
       &#x27;Vavihill&#x27;, &#x27;JFJ&#x27;, &#x27;FKL&#x27;, &#x27;SMEAR-I&#x27;, &#x27;Villum&#x27;, &#x27;Izana&#x27;, &#x27;Maldives&#x27;],
      dtype=&#x27;object&#x27;, name=&#x27;station&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-b06c51cc-fe99-4e69-b69d-b270cb76c979' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-b06c51cc-fe99-4e69-b69d-b270cb76c979' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
<p>To get an overview of the stations:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">station_file</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ZEP</th>
      <th>SMR-II</th>
      <th>ATTO</th>
      <th>MHD</th>
      <th>SGP</th>
      <th>CHC</th>
      <th>BIR-II</th>
      <th>PAL</th>
      <th>Vavihill</th>
      <th>JFJ</th>
      <th>FKL</th>
      <th>SMEAR-I</th>
      <th>Villum</th>
      <th>Izana</th>
      <th>Maldives</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>lon</th>
      <td>11.89</td>
      <td>24.28</td>
      <td>-59.0</td>
      <td>-9.9</td>
      <td>-97.485</td>
      <td>-68.13</td>
      <td>8.25</td>
      <td>24.12</td>
      <td>13.15</td>
      <td>7.98</td>
      <td>25.67</td>
      <td>29.6</td>
      <td>-16.67</td>
      <td>-16.4994</td>
      <td>73.183049</td>
    </tr>
    <tr>
      <th>lat</th>
      <td>78.91</td>
      <td>61.85</td>
      <td>-2.143</td>
      <td>53.33</td>
      <td>36.605</td>
      <td>-16.35</td>
      <td>58.39</td>
      <td>67.97</td>
      <td>56.02</td>
      <td>46.55</td>
      <td>35.34</td>
      <td>67.75</td>
      <td>81.6</td>
      <td>28.309</td>
      <td>6.77648</td>
    </tr>
    <tr>
      <th>grid_nr_echam</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>nice_name</th>
      <td>Zeppelin</td>
      <td>SMEAR-II</td>
      <td>ATTO</td>
      <td>Mace Head</td>
      <td>Southern Great Plains</td>
      <td>Chacaltaya</td>
      <td>Birkenes-II</td>
      <td>Pallas</td>
      <td>Vavihill</td>
      <td>Jungfraujoch</td>
      <td>Finokalia</td>
      <td>Värriö (SMEAR-I)</td>
      <td>Villum</td>
      <td>Izana</td>
      <td>Maldives</td>
    </tr>
    <tr>
      <th>lon_str</th>
      <td>11.89e</td>
      <td>24.28e</td>
      <td>59.00w</td>
      <td>9.90w</td>
      <td>97.48w</td>
      <td>68.13w</td>
      <td>8.25e</td>
      <td>24.12e</td>
      <td>13.15e</td>
      <td>7.98e</td>
      <td>25.67e</td>
      <td>29.60e</td>
      <td>16.67w</td>
      <td>16.50w</td>
      <td>73.18e</td>
    </tr>
    <tr>
      <th>lat_str</th>
      <td>78.91n</td>
      <td>61.85n</td>
      <td>2.14s</td>
      <td>53.33n</td>
      <td>36.60n</td>
      <td>16.35s</td>
      <td>58.39n</td>
      <td>67.97n</td>
      <td>56.02n</td>
      <td>46.55n</td>
      <td>35.34n</td>
      <td>67.75n</td>
      <td>81.60n</td>
      <td>28.31n</td>
      <td>6.78n</td>
    </tr>
    <tr>
      <th>fincl2lonlat</th>
      <td>'11.89e_78.91n'</td>
      <td>'24.28e_61.85n'</td>
      <td>'59.00w_2.14s'</td>
      <td>'9.90w_53.33n'</td>
      <td>'97.48w_36.60n'</td>
      <td>'68.13w_16.35s'</td>
      <td>'8.25e_58.39n'</td>
      <td>'24.12e_67.97n'</td>
      <td>'13.15e_56.02n'</td>
      <td>'7.98e_46.55n'</td>
      <td>'25.67e_35.34n'</td>
      <td>'29.60e_67.75n'</td>
      <td>'16.67w_81.60n'</td>
      <td>'16.50w_28.31n'</td>
      <td>'73.18e_6.78n'</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="example">
<h2>Example<a class="headerlink" href="#example" title="Link to this heading">#</a></h2>
<p>Here is a simple example what one can do with one station. This is a time average for Zeppelin station (Svalbard) at one height level.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ZEP_mean</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="n">dset_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">time_mean</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>  <span class="c1"># Calculate the time mean</span>
    <span class="n">ZEP_mean</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">time_mean</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">station</span><span class="o">=</span><span class="s2">&quot;ZEP&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">plev</span><span class="o">=</span><span class="mi">21</span><span class="p">)</span>  <span class="c1"># Select level and station</span>
<span class="n">sorted_keys</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">ZEP_mean</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">:]))</span> <span class="c1"># sort by the bins by number (technically not necessary but it is neater)</span>
<span class="n">ZEP_sorted</span> <span class="o">=</span> <span class="p">{</span><span class="n">key</span><span class="p">:</span> <span class="n">ZEP_mean</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">sorted_keys</span><span class="p">}</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;bin_index before sorting:&#39;</span><span class="p">,</span> <span class="n">ZEP_mean</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;bin_index after sorting&#39;</span><span class="p">,</span> <span class="n">ZEP_sorted</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>bin_index before sorting: dict_keys([&#39;i3&#39;, &#39;i1&#39;, &#39;i2&#39;, &#39;i4&#39;, &#39;i10&#39;, &#39;i9&#39;, &#39;i7&#39;, &#39;i8&#39;, &#39;i6&#39;, &#39;i5&#39;])
bin_index after sorting dict_keys([&#39;i1&#39;, &#39;i2&#39;, &#39;i3&#39;, &#39;i4&#39;, &#39;i5&#39;, &#39;i6&#39;, &#39;i7&#39;, &#39;i8&#39;, &#39;i9&#39;, &#39;i10&#39;])
</pre></div>
</div>
</div>
</div>
<p>Currently the data is structured as bin.variable, whereas the variablename also incorporates the bin (e.g. “h2so4_1a1), and each dictionary entry is one dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">ZEP_sorted</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
	<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;bin_index:&#39;</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">ZEP_sorted</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">data_vars</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>bin_index: i1 [&#39;h2so4_1a1&#39;]
bin_index: i2 [&#39;h2so4_1a2&#39;]
bin_index: i3 [&#39;h2so4_1a3&#39;]
bin_index: i4 [&#39;du_2a1&#39;, &#39;du_2b1&#39;, &#39;h2so4_2a1&#39;, &#39;oc_2a1&#39;, &#39;oc_2b1&#39;, &#39;ss_2a1&#39;]
bin_index: i5 [&#39;du_2a2&#39;, &#39;du_2b2&#39;, &#39;h2so4_2a2&#39;, &#39;oc_2a2&#39;, &#39;oc_2b2&#39;, &#39;ss_2a2&#39;]
bin_index: i6 [&#39;du_2a3&#39;, &#39;du_2b3&#39;, &#39;h2so4_2a3&#39;, &#39;oc_2a3&#39;, &#39;oc_2b3&#39;, &#39;ss_2a3&#39;]
bin_index: i7 [&#39;du_2a4&#39;, &#39;du_2b4&#39;, &#39;h2so4_2a4&#39;, &#39;oc_2a4&#39;, &#39;oc_2b4&#39;, &#39;ss_2a4&#39;]
bin_index: i8 [&#39;du_2a5&#39;, &#39;du_2b5&#39;, &#39;h2so4_2a5&#39;, &#39;oc_2a5&#39;, &#39;oc_2b5&#39;, &#39;ss_2a5&#39;]
bin_index: i9 [&#39;du_2a6&#39;, &#39;du_2b6&#39;, &#39;h2so4_2a6&#39;, &#39;oc_2a6&#39;, &#39;oc_2b6&#39;, &#39;ss_2a6&#39;]
bin_index: i10 [&#39;du_2a7&#39;, &#39;du_2b7&#39;, &#39;h2so4_2a7&#39;, &#39;oc_2a7&#39;, &#39;oc_2b7&#39;, &#39;ss_2a7&#39;]
</pre></div>
</div>
</div>
</div>
<p>Due to the averaging, we now ended up with a single value per variable in each dataset in the dictionary. This is an attempt to make a nicer representation in the form of a table wit bins as rows and species as columns.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">species_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;du_a&#39;</span><span class="p">,</span> <span class="s1">&#39;du_b&#39;</span><span class="p">,</span> <span class="s1">&#39;h2so4_a&#39;</span><span class="p">,</span> <span class="s1">&#39;oc_a&#39;</span><span class="p">,</span> <span class="s1">&#39;oc_b&#39;</span><span class="p">,</span> <span class="s1">&#39;ss_a&#39;</span><span class="p">]</span> <span class="c1"># a for soluble, b for insoluble, consider changing this to du and du_insoluble</span>
<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">ZEP_sorted</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="n">varnames</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ZEP_sorted</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">data_vars</span><span class="p">)</span>
    <span class="n">species</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="n">s</span><span class="p">[:</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="n">s</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">varnames</span>
		<span class="p">]</span>
    <span class="n">rename_map</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">varnames</span><span class="p">,</span> <span class="n">species</span><span class="p">))</span>
    <span class="n">ZEP_sorted</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">ZEP_sorted</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">rename_map</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">species_names</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">species</span><span class="p">:</span>
            <span class="n">ZEP_sorted</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mf">0.</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">species</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;h2so4_a&#39;]
[&#39;h2so4_a&#39;]
[&#39;h2so4_a&#39;]
[&#39;du_a&#39;, &#39;du_b&#39;, &#39;h2so4_a&#39;, &#39;oc_a&#39;, &#39;oc_b&#39;, &#39;ss_a&#39;]
[&#39;du_a&#39;, &#39;du_b&#39;, &#39;h2so4_a&#39;, &#39;oc_a&#39;, &#39;oc_b&#39;, &#39;ss_a&#39;]
[&#39;du_a&#39;, &#39;du_b&#39;, &#39;h2so4_a&#39;, &#39;oc_a&#39;, &#39;oc_b&#39;, &#39;ss_a&#39;]
[&#39;du_a&#39;, &#39;du_b&#39;, &#39;h2so4_a&#39;, &#39;oc_a&#39;, &#39;oc_b&#39;, &#39;ss_a&#39;]
[&#39;du_a&#39;, &#39;du_b&#39;, &#39;h2so4_a&#39;, &#39;oc_a&#39;, &#39;oc_b&#39;, &#39;ss_a&#39;]
[&#39;du_a&#39;, &#39;du_b&#39;, &#39;h2so4_a&#39;, &#39;oc_a&#39;, &#39;oc_b&#39;, &#39;ss_a&#39;]
[&#39;du_a&#39;, &#39;du_b&#39;, &#39;h2so4_a&#39;, &#39;oc_a&#39;, &#39;oc_b&#39;, &#39;ss_a&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1"># Get values from each bin/variable</span>
<span class="k">for</span> <span class="n">bin_key</span> <span class="ow">in</span> <span class="n">ZEP_sorted</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="n">bin_values</span> <span class="o">=</span> <span class="p">{</span><span class="n">var_key</span><span class="p">:</span> <span class="n">ZEP_sorted</span><span class="p">[</span><span class="n">bin_key</span><span class="p">][</span><span class="n">var_key</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="k">for</span> <span class="n">var_key</span> <span class="ow">in</span> <span class="n">ZEP_sorted</span><span class="p">[</span><span class="n">bin_key</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()}</span>

    <span class="c1"># Add the bin values along with the bin key to the data list</span>
    <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s1">&#39;bin_index&#39;</span><span class="p">:</span> <span class="n">bin_key</span><span class="p">,</span> <span class="o">**</span><span class="n">bin_values</span><span class="p">})</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;bin_index&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                h2so4_a          du_a          du_b          oc_a  \
bin_index                                                           
i1         1.325061e-14  0.000000e+00  0.000000e+00  0.000000e+00   
i2         1.784687e-13  0.000000e+00  0.000000e+00  0.000000e+00   
i3         4.289806e-12  0.000000e+00  0.000000e+00  0.000000e+00   
i4         1.623046e-11  1.734552e-16  3.983981e-17  5.243597e-13   
i5         5.285494e-11  7.083557e-14  9.193136e-13  7.713593e-12   
i6         1.458554e-10  7.269574e-13  2.182388e-11  3.534453e-11   
i7         8.502354e-11  3.762841e-13  5.071292e-11  1.152995e-11   
i8         2.467885e-11  9.475300e-14  6.709647e-10  1.032573e-12   
i9         2.045511e-12  1.502657e-14  1.520320e-09  1.903570e-13   
i10        4.482060e-13  8.427441e-15  4.398044e-10  1.699937e-13   

                   oc_b          ss_a  
bin_index                              
i1         0.000000e+00  0.000000e+00  
i2         0.000000e+00  0.000000e+00  
i3         0.000000e+00  0.000000e+00  
i4         3.988984e-12  9.648818e-16  
i5         7.459203e-11  1.188612e-13  
i6         1.545449e-10  1.943569e-12  
i7         2.676844e-11  3.739875e-12  
i8         2.014282e-12  1.041029e-11  
i9         4.326198e-13  3.699939e-11  
i10        1.723364e-14  5.779686e-12  
</pre></div>
</div>
</div>
</div>
</section>
<section id="visualization">
<h2>Visualization<a class="headerlink" href="#visualization" title="Link to this heading">#</a></h2>
<p>Now we can finally plot the data to get an idea of the distribution of aerosol species. Here is an example with normalized values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Normalize the transposed DataFrame so that each category sums up to 1</span>
<span class="n">df_normalized</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Create a stacked bar plot with categories on the x-axis</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">df_normalized</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">stacked</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Fraction of each aerosol species, Zeppelin station, lev=30&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Bin index&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Normalized Values&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Species&quot;</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../../_images/bbb6a0708f55dec243489ca8b40aa46ab553f2370b5f489464141616b657f65a.png" src="../../../../_images/bbb6a0708f55dec243489ca8b40aa46ab553f2370b5f489464141616b657f65a.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example data: 10 bins with 3 features</span>
<span class="n">bins</span> <span class="o">=</span> <span class="n">df_normalized</span><span class="o">.</span><span class="n">index</span>

<span class="c1"># Calculate the distance matrix</span>
<span class="n">distance_matrix</span> <span class="o">=</span> <span class="n">pdist</span><span class="p">(</span><span class="n">df_normalized</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;euclidean&#39;</span><span class="p">)</span>
<span class="n">dendrogram</span> <span class="o">=</span> <span class="n">sch</span><span class="o">.</span><span class="n">linkage</span><span class="p">(</span><span class="n">distance_matrix</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;ward&#39;</span><span class="p">)</span>  <span class="c1"># You can choose other methods like &#39;single&#39;, &#39;complete&#39;, etc.</span>
<span class="c1"># Create the hierarchical clustering</span>
<span class="c1"># Using the ward method is common for minimizing variance</span>
<span class="n">linkage_matrix</span> <span class="o">=</span> <span class="n">sch</span><span class="o">.</span><span class="n">linkage</span><span class="p">(</span><span class="n">distance_matrix</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;ward&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="n">dendrogram</span> <span class="o">=</span> <span class="n">sch</span><span class="o">.</span><span class="n">dendrogram</span><span class="p">(</span><span class="n">linkage_matrix</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">bins</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Dendrogram for ZEP station at lv30&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;bin_index&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Euclidean Distance&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../../_images/ffd50552cac555a7dbbd1d573506d6b3a7a8c72c84c6c399c5891771cd752ba8.png" src="../../../../_images/ffd50552cac555a7dbbd1d573506d6b3a7a8c72c84c6c399c5891771cd752ba8.png" />
</div>
</div>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../02_read_PPE/"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Read CMIP-PPE data and emulate with Gaussian Processor</p>
      </div>
    </a>
    <a class="right-next"
       href="../../../../nbcon-pdf/"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Exporting notebooks</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#salsa-aerosol-bin-structure">SALSA aerosol bin structure</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-subsets">Data subsets</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-dictionary">Create a dictionary</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#station-names">Station names</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example">Example</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualization">Visualization</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By MetOs-UiO
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025, MetOs, UiO.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>